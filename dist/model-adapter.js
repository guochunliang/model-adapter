!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(t=t||self).ModelAdapter=r()}(this,function(){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t){var r=a(t);return null!==t&&("object"===r||"function"===r)}function l(t){for(var r=t.split("."),n=[],o=0;o<r.length;o++){for(var e=r[o];"\\"===e[e.length-1]&&void 0!==r[o+1];)e=e.slice(0,-1)+".",e+=r[++o];n.push(e)}return n}var i=function(t,r,n){if(!u(t)||"string"!=typeof r)return void 0===n?t:n;for(var o=l(r),e=0;e<o.length;e++){if(!Object.prototype.propertyIsEnumerable.call(t,o[e]))return n;if(null==(t=t[o[e]])){if(e!==o.length-1)return n;break}}return t},c=function(t,r,n){if(!u(t)||"string"!=typeof r)return t;for(var o=t,e=l(r),f=0;f<e.length;f++){var i=e[f];u(t[i])||(t[i]={}),f===e.length-1&&(t[i]=n),t=t[i]}return o};function o(t,r,n){for(var o in n){var e=s(n[o],o),f=i(r,e.path,e.defaultValue);void 0!==r&&p(f,e),e.transformer&&(f=e.transformer(f,r)),t[o]=f}return t}function s(t,r){var n,o,e,f,i;return"string"==typeof t||"function"==typeof t?n=t:t&&"object"===a(t)&&(n=t.path,o=t.defaultValue,e=t.validator,f=t.transformer,i=t.restorer),n?"function"==typeof n&&(n=n()):n=r,"function"==typeof o&&(o=o()),{path:n,defaultValue:o,validator:e,transformer:f,restorer:i}}function p(t,r){if(r.validator){var n=!1;if("string"==typeof r.validator)n=a(t)===r.validator;else if(r.validator instanceof RegExp)n=r.validator.test(t);else if("function"==typeof r.validator)try{n=r.validator(t)}catch(t){console.error("验证器执行异常",t)}n||console.warn("验证数据不通过",r.path,t,r.validator,r)}}return function t(r,n){!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),o(this,n,r),this.$adapt=function(t){o(this,t,r)},this.$restore=function(){return function(t,r){var n={};for(var o in r){var e=s(r[o],o),f=t[o];e.restorer&&(f=e.restorer(f,t)),p(f,e),c(n,e.path,f)}return n}(this,r)}}});
